<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space of Rudransh</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Orbitron:wght@400;700&display=swap');

        :root {
            --primary: #00d2ff;
            --accent: #ff0055;
            --purple: #8e2de2;
            --glass: rgba(255, 255, 255, 0.06);
            --border: rgba(255, 255, 255, 0.12);
            --glow-blue: 0 0 20px rgba(0, 210, 255, 0.6), 0 0 40px rgba(0, 210, 255, 0.3);
            --glow-red: 0 0 20px rgba(255, 0, 85, 0.6), 0 0 40px rgba(255, 0, 85, 0.3);
            --glow-purple: 0 0 20px rgba(142, 45, 226, 0.6);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background: #000;
            height: 100vh;
            color: white;
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            display: flex; justify-content: center; align-items: center;
        }

        .space-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(ellipse at bottom, #0d1b2a 0%, #000000 100%);
            z-index: -3;
        }

        #stars-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; }
        #particle-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 50; }

        /* === LOADER === */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 5000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .loader-title {
            font-family: 'Orbitron', sans-serif; font-size: 1.2rem;
            letter-spacing: 5px; color: var(--primary);
            text-shadow: var(--glow-blue); margin-bottom: 30px;
        }
        .loader-bar-wrap {
            width: 320px; height: 4px; background: rgba(255,255,255,0.1);
            border-radius: 10px; overflow: hidden;
        }
        .loader-bar {
            height: 100%; width: 0%;
            background: linear-gradient(90deg, var(--primary), var(--purple), var(--accent));
            border-radius: 10px;
            transition: width 4s cubic-bezier(0.1, 0.7, 0.3, 1);
        }
        .loader-percent {
            margin-top: 15px; font-size: 0.9rem; color: #888;
            font-family: 'Orbitron', sans-serif;
        }

        /* === INTRO === */
        .intro-wrap {
            width: 90%; max-width: 520px; position: relative; z-index: 10; display: none;
        }
        .screen {
            display: none; flex-direction: column; align-items: center;
            text-align: center; width: 100%; padding: 20px;
        }
        .screen.active {
            display: flex;
            animation: screenIn 0.9s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        .screen.exit { animation: screenOut 0.6s cubic-bezier(0.7, 0, 0.84, 0) forwards; }

        .glow-title {
            font-size: 2.5rem; font-weight: 800; margin-bottom: 20px; white-space: nowrap;
            background: linear-gradient(135deg, #fff 0%, var(--primary) 50%, var(--purple) 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 15px rgba(0, 210, 255, 0.4));
            animation: textShimmer 3s infinite;
        }
        .name-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem; color: var(--primary);
            text-shadow: var(--glow-blue);
            animation: nameGlow 2s ease-in-out infinite alternate;
        }

        @keyframes nameGlow {
            from { text-shadow: 0 0 10px rgba(0,210,255,0.5), 0 0 20px rgba(0,210,255,0.3); }
            to { text-shadow: 0 0 20px rgba(0,210,255,0.8), 0 0 40px rgba(0,210,255,0.5), 0 0 60px rgba(0,210,255,0.3); }
        }
        @keyframes textShimmer {
            0%, 100% { filter: drop-shadow(0 0 15px rgba(0, 210, 255, 0.4)); }
            50% { filter: drop-shadow(0 0 25px rgba(142, 45, 226, 0.6)); }
        }

        h2 { font-size: 1.4rem; color: rgba(255,255,255,0.85); margin-bottom: 30px; font-weight: 400; }

        .fancy-input {
            padding: 18px 25px; width: 100%; border-radius: 50px;
            border: 2px solid rgba(255,255,255,0.15);
            background: rgba(255,255,255,0.05); backdrop-filter: blur(10px);
            color: white; font-size: 1.1rem; text-align: center;
            margin-bottom: 25px; outline: none;
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            font-family: 'Poppins', sans-serif;
        }
        .fancy-input::placeholder { color: rgba(255,255,255,0.3); }
        .fancy-input:focus {
            border-color: var(--primary); box-shadow: var(--glow-blue);
            background: rgba(0, 210, 255, 0.05); transform: scale(1.02);
        }

        .btn {
            padding: 16px 30px; border-radius: 50px; border: none; cursor: pointer;
            font-size: 1rem; font-weight: 600;
            background: linear-gradient(135deg, var(--primary), #0072ff);
            color: white; width: 100%; margin-bottom: 14px;
            position: relative; overflow: hidden;
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 8px 25px rgba(0, 114, 255, 0.3);
            font-family: 'Poppins', sans-serif;
        }
        .btn::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }
        .btn:hover::before { left: 100%; }
        .btn:hover { transform: translateY(-4px) scale(1.02); box-shadow: var(--glow-blue); }
        .btn:active { transform: scale(0.98); }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; }

        /* === DASHBOARD === */
        #dashboard {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(15px);
            z-index: 100; flex-direction: column; overflow-y: auto; padding: 25px;
            animation: fadeIn 1.5s ease;
        }

        .dash-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 25px;
            background: linear-gradient(135deg, rgba(0,210,255,0.08), rgba(142,45,226,0.08));
            border-radius: 20px; border: 1px solid var(--border);
            backdrop-filter: blur(20px); margin-bottom: 30px;
        }
        .brand {
            font-family: 'Orbitron', sans-serif; font-weight: 700;
            color: var(--primary); letter-spacing: 2px; font-size: 1.1rem;
            text-shadow: 0 0 10px rgba(0,210,255,0.5);
        }
        .user-badge {
            font-weight: 600; padding: 8px 20px;
            background: rgba(255,255,255,0.08); border-radius: 30px;
            border: 1px solid var(--border);
        }

        .action-row { display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
        .action-card {
            flex: 1; min-width: 150px; padding: 30px 20px; border-radius: 20px;
            text-align: center; cursor: pointer;
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            border: 1px solid transparent; position: relative; overflow: hidden;
        }
        .action-card::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
            opacity: 0; transition: 0.5s;
        }
        .action-card:hover::before { opacity: 1; }
        .action-card:hover { transform: translateY(-8px) scale(1.03); }
        .action-card h3 { margin: 0; font-size: 1.2rem; position: relative; z-index: 1; }
        .action-card p { font-size: 0.8rem; opacity: 0.7; margin-top: 8px; position: relative; z-index: 1; }

        .crush-card { background: linear-gradient(135deg, #ff0055, #ff416c); box-shadow: 0 10px 30px rgba(255, 0, 85, 0.3); }
        .crush-card:hover { box-shadow: var(--glow-red); }
        .jadoo-card { background: linear-gradient(135deg, #8e2de2, #4a00e0); box-shadow: 0 10px 30px rgba(142, 45, 226, 0.3); }
        .jadoo-card:hover { box-shadow: var(--glow-purple); }

        .link-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .link-card {
            background: var(--glass); border: 1px solid var(--border); padding: 30px;
            border-radius: 20px; text-align: center;
            transition: all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); backdrop-filter: blur(10px);
        }
        .link-card:hover {
            transform: translateY(-8px); border-color: var(--primary);
            background: rgba(0, 210, 255, 0.05); box-shadow: 0 15px 40px rgba(0, 210, 255, 0.1);
        }
        .link-card h3 { color: var(--primary); margin-bottom: 10px; }
        .card-link {
            display: inline-block; padding: 12px 30px; margin-top: 15px;
            border: 2px solid var(--primary); color: var(--primary); text-decoration: none;
            border-radius: 30px; font-weight: 600; transition: 0.3s;
        }
        .card-link:hover { background: var(--primary); color: black; box-shadow: var(--glow-blue); }

        .bottom-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 60px; }
        .zone-box {
            background: linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
            border: 1px solid var(--border); padding: 30px;
            border-radius: 20px; text-align: center; backdrop-filter: blur(5px);
        }
        .zone-box h2 { margin-bottom: 20px; }
        .btn-wrap { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }

        .mini-btn {
            padding: 12px 20px; border-radius: 30px; border: 1px solid var(--border);
            background: rgba(255,255,255,0.05); color: white; cursor: pointer;
            font-size: 0.9rem; font-weight: 500; transition: 0.3s; font-family: 'Poppins', sans-serif;
        }
        .mini-btn:hover { background: var(--primary); border-color: var(--primary); color: black; transform: scale(1.05); }
        .meme-btn { background: linear-gradient(135deg, rgba(142,45,226,0.2), rgba(74,0,224,0.2)); border-color: rgba(142,45,226,0.3); }
        .meme-btn:hover { background: var(--purple); border-color: var(--purple); }
        .meme-btn.playing { background: var(--accent); border-color: var(--accent); animation: pulseBtn 1s infinite; }
        @keyframes pulseBtn { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        /* === OVERLAY === */
        #overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); backdrop-filter: blur(20px);
            z-index: 2000; flex-direction: column; align-items: center; justify-content: center;
        }
        .close-x {
            position: absolute; top: 25px; right: 25px; width: 45px; height: 45px;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2);
            color: #fff; border-radius: 50%; font-size: 1.3rem; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            transition: 0.3s; font-family: 'Poppins';
        }
        .close-x:hover { border-color: var(--accent); color: var(--accent); background: rgba(255,0,85,0.1); transform: rotate(90deg); }

        .ov-content { width: 90%; max-width: 480px; text-align: center; position: relative; }
        .ov-enter { animation: screenIn 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        .ov-exit { animation: screenOut 0.5s forwards; }

        .denied-text {
            color: var(--accent); font-size: 2rem; font-weight: 800;
            text-shadow: 0 0 30px rgba(255,0,85,0.5); margin-bottom: 25px; animation: shake 0.5s;
        }
        .loading-text { color: var(--primary); font-size: 1.6rem; font-weight: 600; text-shadow: 0 0 20px rgba(0,210,255,0.5); animation: pulse 1.2s infinite; }
        .success-text { color: #00ff88; font-size: 2rem; font-weight: 800; text-shadow: 0 0 30px rgba(0,255,136,0.5); }

        /* === DODGE BUTTON (For Crush & Questions) === */
        .dodge-btn {
            position: fixed;
            padding: 20px 40px; border-radius: 50px; border: none;
            font-size: 1.2rem; font-weight: 700; cursor: pointer;
            background: linear-gradient(135deg, #ff0055, #ff416c);
            color: white; z-index: 3000;
            box-shadow: var(--glow-red);
            transition: all 0.15s ease-out;
            font-family: 'Poppins', sans-serif;
        }

        /* Runaway button inside questions */
        .runaway-btn {
            position: absolute !important;
            transition: all 0.12s ease-out !important;
            z-index: 10;
        }

        /* Question container needs relative position */
        .q-container {
            position: relative;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .q-btn-area {
            position: relative;
            width: 100%;
            min-height: 120px;
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
        }

        .good-btn {
            padding: 16px 40px; border-radius: 50px; border: none; cursor: pointer;
            font-size: 1rem; font-weight: 600;
            background: linear-gradient(135deg, #00ff88, #00b359);
            color: black; box-shadow: 0 8px 25px rgba(0, 255, 136, 0.3);
            transition: 0.3s; font-family: 'Poppins', sans-serif;
            z-index: 5;
        }
        .good-btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(0,255,136,0.6); }

        .bad-btn {
            padding: 16px 40px; border-radius: 50px; border: none; cursor: pointer;
            font-size: 1rem; font-weight: 600;
            background: linear-gradient(135deg, #ff0055, #cc0044);
            color: white; box-shadow: 0 8px 25px rgba(255, 0, 85, 0.3);
            transition: all 0.12s ease-out; font-family: 'Poppins', sans-serif;
            z-index: 5; position: relative;
        }

        @keyframes screenIn {
            from { opacity: 0; transform: translateY(60px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes screenOut { to { opacity: 0; transform: translateY(-40px) scale(0.95); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-15px); } 40% { transform: translateX(15px); }
            60% { transform: translateX(-10px); } 80% { transform: translateX(10px); }
        }

        .ttt-board { display: grid; grid-template-columns: repeat(3, 85px); gap: 10px; margin: 25px auto; }
        .ttt-cell {
            width: 85px; height: 85px;
            background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px; font-size: 2.5rem; font-weight: bold;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.3s;
        }
        .ttt-cell:hover { background: rgba(255,255,255,0.12); transform: scale(1.05); }

        .rps-arena { display: flex; justify-content: center; gap: 25px; margin: 30px 0; }
        .rps-pick {
            font-size: 3.5rem; cursor: pointer; padding: 20px;
            background: rgba(255,255,255,0.05); border: 2px solid var(--border);
            border-radius: 20px; transition: 0.4s;
        }
        .rps-pick:hover {
            transform: scale(1.2) translateY(-10px); border-color: var(--primary);
            box-shadow: var(--glow-blue); background: rgba(0,210,255,0.1);
        }

        @media (max-width: 600px) {
            .glow-title { font-size: 1.8rem; }
            .name-title { font-size: 2.2rem; }
            .action-row { flex-direction: column; }
            .ttt-board { grid-template-columns: repeat(3, 70px); }
            .ttt-cell { width: 70px; height: 70px; font-size: 2rem; }
        }
    </style>
</head>
<body>

    <div class="space-bg"></div>
    <canvas id="stars-canvas"></canvas>
    <canvas id="particle-canvas"></canvas>
    <canvas id="confetti-canvas"></canvas>

    <!-- LOADER -->
    <div id="loader">
        <div class="loader-title">ENTERING SPACE</div>
        <div class="loader-bar-wrap"><div class="loader-bar" id="load-bar"></div></div>
        <div class="loader-percent" id="load-pct">0%</div>
    </div>

    <!-- INTRO -->
    <div class="intro-wrap" id="intro">
        <div id="s1" class="screen active"><h1 class="glow-title">Welcome to the Space Of...</h1></div>
        <div id="s2" class="screen"><h1 class="name-title">Rudransh Singh</h1></div>
        <div id="s3" class="screen">
            <h2>Enter Your Name</h2>
            <input class="fancy-input" type="text" id="nameInput" placeholder="‚ú® Type your name..." autocomplete="off">
            <button class="btn" onclick="saveName()">Next ‚ûú</button>
        </div>
        <div id="s4" class="screen">
            <h2>Who are you?</h2>
            <button class="btn" onclick="goNext('s4','s5')">I'm Friend of Rudransh</button>
            <button class="btn" onclick="goNext('s4','s5')">I'm Close Friend of Rudransh</button>
            <button class="btn" onclick="goNext('s4','s5')">I Just Know About Rudransh</button>
        </div>
        <div id="s5" class="screen">
            <h2>Are you a...</h2>
            <div class="btn-grid">
                <button class="btn" onclick="setGender('Girl')">Girl üë©</button>
                <button class="btn" onclick="setGender('Boy')">Boy üë®</button>
            </div>
        </div>
        <div id="s6" class="screen">
            <h2>Current Status</h2>
            <button class="btn" onclick="setStatus('School')">School Student üéí</button>
            <button class="btn" onclick="setStatus('College')">College Student üéì</button>
            <button class="btn" onclick="setStatus('Adult')">Adult / Working üíº</button>
        </div>
        <div id="s7" class="screen">
            <h2>Which Class?</h2>
            <div class="btn-grid">
                <button class="btn" onclick="finishIntro()">6th - 8th</button>
                <button class="btn" onclick="finishIntro()">9th - 10th</button>
                <button class="btn" onclick="finishIntro()">11th - 12th</button>
                <button class="btn" onclick="finishIntro()">Other</button>
            </div>
        </div>
        <div id="s8" class="screen">
            <h1 class="glow-title">üéâ Welcome üéâ</h1>
            <h1 id="welcomeName" class="name-title">User</h1>
        </div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard">
        <div class="dash-header">
            <div class="brand">üöÄ RUDRANSH SPACE</div>
            <div class="user-badge" id="dashName">User</div>
        </div>

        <div class="action-row">
            <div class="action-card crush-card" onclick="initCrushDodge()">
                <h3>‚ù§Ô∏è Know About My Crush</h3>
                <p>Click if you dare...</p>
            </div>
            <div class="action-card jadoo-card" onclick="openOv('jadoo')">
                <h3>‚ú® Jadoo</h3>
                <p>See some magic...</p>
            </div>
        </div>

        <div class="link-grid">
            <div class="link-card">
                <h3>Download Anything</h3>
                <p>Movies, Books, Files & More</p>
                <a href="https://ewasion.github.io/opendirectory-finder/" target="_blank" class="card-link">Open Finder</a>
            </div>
            <div class="link-card">
                <h3>Premium Software</h3>
                <p>Get paid PC software for free</p>
                <a href="https://filecr.com/us-en/" target="_blank" class="card-link">Visit FileCR</a>
            </div>
        </div>

        <div class="bottom-grid">
            <div class="zone-box">
                <h2>üéÆ Arcade Zone</h2>
                <div class="btn-wrap">
                    <button class="mini-btn" onclick="openOv('ttt')">Tic Tac Toe</button>
                    <button class="mini-btn" onclick="openOv('rps')">Rock Paper Scissors</button>
                </div>
            </div>
            <div class="zone-box">
                <h2>üòÇ Memes Suno</h2>
                <div class="btn-wrap" id="meme-wrap">
                    <button class="mini-btn meme-btn" onclick="playMeme('elvish.mp3',this)" data-name="Elvish Bhai">Elvish Bhai</button>
                    <button class="mini-btn meme-btn" onclick="playMeme('last.mp3',this)" data-name="Chheen Tapak">Chheen Tapak</button>
                    <button class="mini-btn meme-btn" onclick="playMeme('kyun.mp3',this)" data-name="Kyun Nahi Padhai">Kyun Nahi Padhai</button>
                    <button class="mini-btn meme-btn" onclick="playMeme('laugh.mp3',this)" data-name="Hasiiiii">Hasiiiii</button>
                    <button class="mini-btn meme-btn" onclick="playMeme('baigan.mp3',this)" data-name="Baigan">Baigan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- OVERLAY -->
    <div id="overlay">
        <button class="close-x" onclick="closeOv()">‚úï</button>
        <div id="ov-body" class="ov-content"></div>
    </div>

    <script>
        /* ======== STARS ======== */
        const stC = document.getElementById('stars-canvas');
        const stX = stC.getContext('2d');
        stC.width = innerWidth; stC.height = innerHeight;
        const starArr = Array(150).fill().map(() => ({
            x: Math.random() * stC.width, y: Math.random() * stC.height,
            r: Math.random() * 2, speed: Math.random() * 0.5 + 0.1,
            tw: Math.random() * Math.PI
        }));
        function drawStars() {
            stX.clearRect(0, 0, stC.width, stC.height);
            starArr.forEach(s => {
                s.y += s.speed; s.tw += 0.02;
                if (s.y > stC.height) s.y = 0;
                stX.fillStyle = `rgba(255,255,255,${0.5 + 0.5 * Math.sin(s.tw)})`;
                stX.beginPath(); stX.arc(s.x, s.y, s.r, 0, Math.PI * 2); stX.fill();
            });
            requestAnimationFrame(drawStars);
        }
        drawStars();

        /* ======== PARTICLES ======== */
        const ptC = document.getElementById('particle-canvas');
        const ptX = ptC.getContext('2d');
        ptC.width = innerWidth; ptC.height = innerHeight;
        const pts = Array(30).fill().map(() => ({
            x: Math.random() * ptC.width, y: Math.random() * ptC.height,
            r: Math.random() * 1.5, vx: (Math.random() - 0.5) * 0.3, vy: (Math.random() - 0.5) * 0.3,
            c: ['rgba(0,210,255,0.3)', 'rgba(142,45,226,0.3)', 'rgba(255,0,85,0.2)'][Math.floor(Math.random() * 3)]
        }));
        function drawPts() {
            ptX.clearRect(0, 0, ptC.width, ptC.height);
            pts.forEach(p => {
                p.x += p.vx; p.y += p.vy;
                if (p.x < 0 || p.x > ptC.width) p.vx *= -1;
                if (p.y < 0 || p.y > ptC.height) p.vy *= -1;
                ptX.fillStyle = p.c;
                ptX.beginPath(); ptX.arc(p.x, p.y, p.r, 0, Math.PI * 2); ptX.fill();
            });
            requestAnimationFrame(drawPts);
        }
        drawPts();

        /* ======== GLOBALS ======== */
        let userName = "User";
        let userGender = "Boy";
        let memeAudio = null;

        function playSound(f) { try { new Audio(f).play(); } catch (e) { } }

        function playMeme(file, btn) {
            if (memeAudio) { memeAudio.pause(); memeAudio.currentTime = 0; }
            document.querySelectorAll('.meme-btn').forEach(b => {
                b.classList.remove('playing');
                b.innerText = b.getAttribute('data-name');
            });
            btn.classList.add('playing');
            btn.innerText = "Playing... üîä";
            memeAudio = new Audio(file);
            memeAudio.play();
            memeAudio.onended = () => {
                btn.classList.remove('playing');
                btn.innerText = btn.getAttribute('data-name');
                memeAudio = null;
            };
        }

        /* ======== LOADER ======== */
        window.onload = () => {
            let bar = document.getElementById('load-bar');
            let pct = document.getElementById('load-pct');
            let progress = 0;
            let inv = setInterval(() => {
                progress += Math.random() * 4 + 1;
                if (progress > 100) progress = 100;
                bar.style.width = progress + '%';
                pct.innerText = Math.floor(progress) + '%';
                if (progress >= 100) {
                    clearInterval(inv);
                    setTimeout(() => {
                        document.getElementById('loader').style.opacity = '0';
                        document.getElementById('loader').style.transition = 'opacity 0.8s';
                        setTimeout(() => {
                            document.getElementById('loader').style.display = 'none';
                            document.getElementById('intro').style.display = 'block';
                            setTimeout(() => goNext('s1', 's2'), 2000);
                            setTimeout(() => goNext('s2', 's3'), 5000);
                        }, 800);
                    }, 500);
                }
            }, 100);
        };

        /* ======== INTRO ======== */
        function goNext(curr, next) {
            let c = document.getElementById(curr);
            let n = document.getElementById(next);
            c.classList.remove('active'); c.classList.add('exit');
            setTimeout(() => {
                c.style.display = 'none'; c.classList.remove('exit');
                n.style.display = 'flex'; n.classList.add('active');
            }, 600);
        }

        function saveName() {
            let v = document.getElementById('nameInput').value.trim();
            if (!v) return alert("Naam to daal bhai!");
            userName = v.toLowerCase().replace(/(^\w)|(\s+\w)/g, l => l.toUpperCase());
            document.getElementById('welcomeName').innerText = userName;
            document.getElementById('dashName').innerText = userName;
            goNext('s3', 's4');
        }

        function setGender(g) { userGender = g; goNext('s5', 's6'); }
        function setStatus(s) { if (s === 'School') goNext('s6', 's7'); else finishIntro(); }

        function finishIntro() {
            let active = document.querySelector('.intro-wrap .active');
            active.classList.remove('active'); active.classList.add('exit');
            setTimeout(() => {
                active.style.display = 'none';
                let end = document.getElementById('s8');
                end.style.display = 'flex'; end.classList.add('active');
                fireConfetti();
                setTimeout(() => {
                    document.getElementById('intro').style.display = 'none';
                    document.getElementById('dashboard').style.display = 'flex';
                }, 4000);
            }, 600);
        }

        /* ======== CONFETTI ======== */
        function fireConfetti() {
            const c = document.getElementById('confetti-canvas');
            const x = c.getContext('2d');
            c.width = innerWidth; c.height = innerHeight;
            const cols = ['#ff0055', '#00ff88', '#00d2ff', '#ffff00', '#ff00ff', '#ffffff'];
            let arr = [];
            for (let i = 0; i < 200; i++) {
                arr.push({
                    x: c.width / 2, y: c.height / 2,
                    vx: (Math.random() - 0.5) * 18, vy: (Math.random() - 0.5) * 18,
                    col: cols[Math.floor(Math.random() * cols.length)],
                    size: Math.random() * 6 + 3, rot: Math.random() * 360,
                    life: 120 + Math.random() * 40
                });
            }
            function anim() {
                x.clearRect(0, 0, c.width, c.height);
                arr.forEach((p, i) => {
                    p.x += p.vx; p.y += p.vy; p.vy += 0.15; p.rot += 3; p.life--;
                    x.save(); x.translate(p.x, p.y); x.rotate(p.rot * Math.PI / 180);
                    x.fillStyle = p.col; x.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);
                    x.restore();
                    if (p.life <= 0) arr.splice(i, 1);
                });
                if (arr.length > 0) requestAnimationFrame(anim);
            }
            anim();
        }

        /* ======== OVERLAY ======== */
        const overlay = document.getElementById('overlay');
        const ovBody = document.getElementById('ov-body');

        function openOv(type) {
            overlay.style.display = 'flex';
            overlay.style.animation = 'fadeIn 0.4s';
            if (type === 'crush') crushStart();
            if (type === 'jadoo') jadooStart();
            if (type === 'ttt') tttStart();
            if (type === 'rps') rpsStart();
        }

        function closeOv() { overlay.style.display = 'none'; ovBody.innerHTML = ''; }

        function swapContent(html) {
            ovBody.classList.add('ov-exit');
            setTimeout(() => {
                ovBody.innerHTML = html;
                ovBody.classList.remove('ov-exit');
                ovBody.classList.add('ov-enter');
                setTimeout(() => ovBody.classList.remove('ov-enter'), 700);
            }, 500);
        }

        /* ======== CRUSH DODGE ======== */
        let dodgeCount = 0;
        let dodgeBtn = null;

        function initCrushDodge() {
            dodgeCount = 0;
            if (dodgeBtn) dodgeBtn.remove();

            let darkBg = document.createElement('div');
            darkBg.id = 'dodge-bg';
            darkBg.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:2999;animation:fadeIn 0.3s;';
            document.body.appendChild(darkBg);

            dodgeBtn = document.createElement('button');
            dodgeBtn.className = 'dodge-btn';
            dodgeBtn.innerText = "‚ù§Ô∏è Know About My Crush";
            dodgeBtn.style.top = '50%'; dodgeBtn.style.left = '50%';
            dodgeBtn.style.transform = 'translate(-50%, -50%)';
            document.body.appendChild(dodgeBtn);

            dodgeBtn.onclick = handleDodgeClick;
        }

        const dodgeTexts = ["Do You Want to Know?", "Are You Surely Interested?", "Sahi Me?"];

        function handleDodgeClick() {
            dodgeCount++;
            if (dodgeCount <= 3) {
                let maxX = window.innerWidth - 280;
                let maxY = window.innerHeight - 80;
                dodgeBtn.style.left = Math.random() * maxX + 'px';
                dodgeBtn.style.top = Math.random() * maxY + 'px';
                dodgeBtn.style.transform = 'translate(0, 0)';
                dodgeBtn.innerText = dodgeTexts[dodgeCount - 1];
            } else {
                dodgeBtn.remove(); dodgeBtn = null;
                let bg = document.getElementById('dodge-bg');
                if (bg) bg.remove();
                openOv('crush');
            }
        }

        /* ======== CRUSH FLOW ======== */
        function crushStart() {
            let nums = Array.from({ length: 4 }, () => Math.floor(Math.random() * 100) + 1);
            let h = `<h2>Choose a Number</h2><div class="btn-grid">`;
            nums.forEach(n => h += `<button class="btn" onclick="crushAnimal()">${n}</button>`);
            ovBody.innerHTML = h + `</div>`;
        }

        window.crushAnimal = () => {
            let a = ["Panda", "Tiger", "Lion", "Cat", "Dog", "Fox"].sort(() => 0.5 - Math.random()).slice(0, 4);
            let h = `<h2>Choose an Animal</h2><div class="btn-grid">`;
            a.forEach(i => h += `<button class="btn" onclick="crushFruit()">${i}</button>`);
            swapContent(h + `</div>`);
        }

        window.crushFruit = () => {
            let f = ["Apple", "Mango", "Kiwi", "Peach", "Berry"].sort(() => 0.5 - Math.random()).slice(0, 4);
            let h = `<h2>Choose a Fruit</h2><div class="btn-grid">`;
            f.forEach(i => h += `<button class="btn" onclick="crushFakeLoad()">${i}</button>`);
            swapContent(h + `</div>`);
        }

        window.crushFakeLoad = () => {
            let msgs = ["Authenticating...", "Consulting Owner...", "Asking Permission...", "Almost Done..."];
            let i = 0;
            swapContent(`<h2 class="loading-text">${msgs[0]}</h2>`);
            let inv = setInterval(() => {
                i++;
                if (i < msgs.length) ovBody.innerHTML = `<h2 class="loading-text ov-enter">${msgs[i]}</h2>`;
                else { clearInterval(inv); crushDenied(); }
            }, 1500);
        }

        function crushDenied() {
            playSound('sound.mp3');
            swapContent(`
                <div class="denied-text">Sorry ${userName},<br>Permission Denied By Rudransh.</div>
                <button class="btn" onclick="crushRequestAgain()" style="width:70%">Request Again</button>
            `);
        }

        window.crushRequestAgain = () => {
            swapContent(`<h2 class="loading-text">Asking Again...</h2>`);
            setTimeout(() => showDodgeQuestion("Bataa Du?", "q1"), 2000);
        }

        /* ======== DODGE QUESTION SYSTEM ======== */
        // The negative button runs away on hover & click

        function showDodgeQuestion(question, step) {
            let goodText, badText;

            if (step === 'q2') {
                let suf = userGender === 'Girl' ? 'i' : 'a';
                goodText = `Nahi Bataung${suf}`;
                badText = `Bataung${suf}`;
            } else {
                goodText = "Yes";
                badText = "No";
            }

            let html = `
                <div class="q-container" id="qBox">
                    <h2>${question}</h2>
                    <div class="q-btn-area" id="btnArea">
                        <button class="good-btn" id="goodBtn">${goodText}</button>
                        <button class="bad-btn" id="badBtn">${badText}</button>
                    </div>
                </div>
            `;

            swapContent(html);

            // Wait for DOM to update
            setTimeout(() => {
                let badBtn = document.getElementById('badBtn');
                let goodBtn = document.getElementById('goodBtn');
                let area = document.getElementById('btnArea');

                if (!badBtn || !goodBtn) return;

                // Function to make bad button run away
                function dodgeBad() {
                    let areaRect = area.getBoundingClientRect();
                    // Calculate random position within overlay area
                    let maxX = window.innerWidth - 200;
                    let maxY = window.innerHeight - 100;
                    let newX = Math.random() * maxX;
                    let newY = Math.random() * maxY;

                    badBtn.style.position = 'fixed';
                    badBtn.style.left = newX + 'px';
                    badBtn.style.top = newY + 'px';
                    badBtn.style.zIndex = '9999';
                    badBtn.style.transition = 'all 0.12s ease-out';
                }

                // Hover = dodge (desktop)
                badBtn.addEventListener('mouseenter', dodgeBad);
                // Touch = dodge (mobile)
                badBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    dodgeBad();
                });
                // Click = also dodge (safety)
                badBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    dodgeBad();
                });

                // Good button click
                goodBtn.onclick = () => {
                    // Remove floating bad button
                    if (badBtn) badBtn.remove();
                    handleGoodAnswer(step);
                };

            }, 600);
        }

        function handleGoodAnswer(step) {
            if (step === 'q1') {
                showDodgeQuestion(
                    `Kisi Ko Batayeg${userGender === 'Girl' ? 'i' : 'a'} to nahi?`,
                    'q2'
                );
            }
            else if (step === 'q2') {
                showDodgeQuestion("Sach Me...?", "q3");
            }
            else if (step === 'q3') {
                showDodgeQuestion("Bhagwaan Kasam...?", "q4");
            }
            else if (step === 'q4') {
                showDodgeQuestion("Rudransh Ki Kasam...?", "q5");
            }
            else if (step === 'q5') {
                crushFinalReveal();
            }
        }

        function crushFinalReveal() {
            let msgs = ["Ruko...", "Gam Khao...", "Authenticating...", "Asking...", "Almost There..."];
            let i = 0;
            swapContent(`<h2 class="loading-text">${msgs[0]}</h2>`);
            let inv = setInterval(() => {
                i++;
                if (i < msgs.length) ovBody.innerHTML = `<h2 class="loading-text ov-enter">${msgs[i]}</h2>`;
                else {
                    clearInterval(inv);
                    playSound('last.mp3');
                    swapContent(`
                        <h2 style="margin-bottom:15px;">Wo Keh Raha Hai -</h2>
                        <h1 class="success-text">"Face to Face Milkar Batayenge" üòÇ</h1>
                        <button class="btn" onclick="closeOv()" style="width:50%; margin-top:25px;">Close</button>
                    `);
                }
            }, 1500);
        }

        /* ======== JADOO ======== */
        function jadooStart() {
            let steps = [
                "Ek Sec.....",
                "Gam Khao.....",
                "Jadoo Aa Raha Hai....",
                "Gam Khaye Jao 2 Min...",
                `Koi Jadu Vadu Nahi Chupchap Padh le Jake ${userName} üòÇ`
            ];
            let i = 0;
            ovBody.innerHTML = `<h2 style="color:#bf55ec; font-size:1.8rem;">${steps[0]}</h2>`;
            let inv = setInterval(() => {
                i++;
                if (i < steps.length)
                    ovBody.innerHTML = `<h2 style="color:#bf55ec; font-size:1.8rem;" class="ov-enter">${steps[i]}</h2>`;
                else clearInterval(inv);
            }, 2000);
        }

        /* ======== GAMES ======== */
        function tttStart() {
            ovBody.innerHTML = `<h3>Tic Tac Toe</h3>
            <div class="ttt-board" id="tttGrid"></div>
            <h3 id="tttMsg">X Turn</h3>
            <button class="btn" onclick="tttStart()" style="width:auto">Reset</button>`;
            let b = Array(9).fill(null), turn = 'X';
            let grid = document.getElementById('tttGrid');
            b.forEach((_, i) => {
                let cell = document.createElement('div');
                cell.className = 'ttt-cell';
                cell.onclick = () => {
                    if (b[i] || tttWin(b)) return;
                    b[i] = turn; cell.innerText = turn;
                    cell.style.color = turn === 'X' ? 'var(--primary)' : 'var(--accent)';
                    cell.style.textShadow = turn === 'X' ? '0 0 10px var(--primary)' : '0 0 10px var(--accent)';
                    if (tttWin(b)) document.getElementById('tttMsg').innerText = `${turn} Wins! üéâ`;
                    else if (!b.includes(null)) document.getElementById('tttMsg').innerText = "Draw!";
                    else { turn = turn === 'X' ? 'O' : 'X'; document.getElementById('tttMsg').innerText = `${turn} Turn`; }
                };
                grid.appendChild(cell);
            });
        }

        function tttWin(b) {
            return [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]]
                .some(c => b[c[0]] && b[c[0]] === b[c[1]] && b[c[0]] === b[c[2]]);
        }

        function rpsStart() {
            ovBody.innerHTML = `<h3>Rock Paper Scissors</h3>
            <div class="rps-arena">
                <div class="rps-pick" onclick="rpsPlay('Rock')">ü™®</div>
                <div class="rps-pick" onclick="rpsPlay('Paper')">üìÑ</div>
                <div class="rps-pick" onclick="rpsPlay('Scissors')">‚úÇÔ∏è</div>
            </div>
            <h3 id="rpsRes" style="min-height:80px;">Choose Your Weapon!</h3>`;
        }

        window.rpsPlay = (u) => {
            let resEl = document.getElementById('rpsRes');
            resEl.innerHTML = `<span class="loading-text">Choosing...</span>`;
            setTimeout(() => {
                let opts = ['Rock', 'Paper', 'Scissors'];
                let icons = { Rock: 'ü™®', Paper: 'üìÑ', Scissors: '‚úÇÔ∏è' };
                let c = opts[Math.floor(Math.random() * 3)];
                let r = (u === c) ? "Tie! ü§ù" :
                    ((u === 'Rock' && c === 'Scissors') || (u === 'Paper' && c === 'Rock') || (u === 'Scissors' && c === 'Paper'))
                        ? "You Win! üéâ" : "You Lose! üò¢";
                let col = r.includes('Win') ? '#00ff88' : r.includes('Lose') ? '#ff0055' : '#ffff00';
                resEl.innerHTML = `
                    <div class="ov-enter">
                        You: ${icons[u]} vs CPU: ${icons[c]}<br>
                        <span style="color:${col}; font-size:1.8rem; font-weight:bold;">${r}</span>
                    </div>`;
            }, 800);
        }
    </script>
</body>
</html>
